<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <style>
    body {
      margin: 0;
      background: transparent;
      overflow: hidden;
      display: flex;
      align-items: center;
      gap: 35px;
      padding: 20px;
    }

    #map {
      width: 300px;
      height: auto;
    }

    svg {
      width: 800px;
      height: 200px;
    }

    text {
      font-family: 'Segoe UI', sans-serif;
      font-size: 120px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <img id="map" src="https://static.vecteezy.com/system/resources/thumbnails/017/197/464/small/usa-concept-represented-by-map-and-flag-icon-isolated-and-flat-illustration-free-png.png" alt="US Map" />

  <svg viewBox="0 0 800 200" preserveAspectRatio="xMinYMid meet">
    <defs>
      <linearGradient id="usFlagGradient" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="blue" />
        <stop offset="50%" stop-color="white" />
        <stop offset="100%" stop-color="red" />
      </linearGradient>
    </defs>
    <text x="0" y="150" fill="url(#usFlagGradient)" id="stateText">STATE: State 1/50</text>
  </svg>

  <script>
    const fieldData = {
      stateName: "State",
      stateNumber: 1
    };

    const updateText = () => {
      document.getElementById("stateText").textContent = `STATE: ${fieldData.stateName} ${fieldData.stateNumber}/50`;
    };

    window.addEventListener('onEventReceived', function (obj) {
      if (!obj.detail.event || obj.detail.listener !== 'message') return;
      const msg = obj.detail.event.data.text;
      const isMod = obj.detail.event.data.tags.mod || obj.detail.event.data.tags.badges?.broadcaster;

      if (!isMod) return;

      if (msg.startsWith('!state ')) {
        fieldData.stateName = msg.split(' ')[1].toUpperCase();
        updateText();
      }

      if (msg.startsWith('!staten ')) {
        const num = parseInt(msg.split(' ')[1]);
        if (!isNaN(num) && num >= 0 && num <= 50) {
          fieldData.stateNumber = num;
          updateText();
        }
      }
    });

    updateText();
  </script>
</body>
</html>
